var IngrowEventGrabber=function(e){"use strict";var n,t,o=(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t,o=arguments[n];for(t in o)Object.prototype.hasOwnProperty.call(o,t)&&(e[t]=o[t])}return e},n=function(e,n,t){return n&&o(e.prototype,n),t&&o(e,t),e};function o(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var i=(n(a,null,[{key:"getRandomString",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",t=0;t<32;t++)n+=e.charAt(Math.floor(Math.random()*e.length));return n}},{key:"setCookie",value:function(e){var n=a.getRandomString();return document.cookie=e+"="+n,n}},{key:"getCookie",value:function(e){for(var n=e+"=",t=document.cookie.split(";"),o=0;o<t.length;o++){for(var r=t[o];" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(n))return r.substring(n.length,r.length)}return""}},{key:"checkCookie",value:function(e){return""!=a.getCookie(e)}}]),a);function a(){r(this,a)}n(s,[{key:"sendEvent",value:function(e,n){return fetch(this.apiEndpoint+"/v1",{method:"POST",headers:{"api-key":this.apiKey},body:JSON.stringify({ingrow:{stream:e,project:this.projectID},enrichment:[{name:"session",input:{anonymous_id:this.anonymousId,user_id:2<arguments.length&&void 0!==arguments[2]?arguments[2]:""}}],event:t({},this.IP,n)})})}}]),n=s;function s(e,n){r(this,s),this.apiKey=e,this.projectID=n,this.apiEndpoint="https://event.ingrow.co",this.anonymousId=i.checkCookie("ingrow_events_anonymous_id")?i.getCookie("ingrow_events_anonymous_id"):i.setCookie("ingrow_events_anonymous_id"),this.ip={IP:"autofill"}}e.default=n}((n={exports:{}},n.exports)),n.exports);(t=o)&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")&&t.default;var a=o;function s(e){var{nodeName:n,id:t,className:o}=e;return{path:getDomPath(e).join(" > "),nodeName:n,id:t,className:o}}let d={};function r(o){return e=>{var{target:n,clientX:t,clientY:e}=e;d={isTouch:o,x:t,y:e,...s(n)}}}function i(i,a){return function(e){var{target:n,clientX:t,clientY:o}=e,r=t-d.x,e=o-d.y,e=r*r+e*e^!0?a?"tap":"click":"drag",e={isTouch:a,x:t,y:o,...s(n),action:e};i(e)}}function u(e){const n=document.body.addEventListener;n("mousedown",r(e)),n("touchstart",r(e)),n("mouseup",i(e)),n("touchend",i(e,!0))}function c(n){document.addEventListener("DOMContentLoaded",()=>{n({action:"load"})});const e=window.addEventListener;e("beforeunload",function(e){n({action:"load"})}),e("unload",function(e){n({action:"load"})})}function f(o){window.onerror=function(e,n,t){o({error:e,url:n,line:t})}}var v=300,l=[];function h(e){for(var n=0;n<l.length;n++)l[n](e)}function p(n){g.addEventListener(n,function e(){m[n]=!0,g.removeEventListener(n,e,!1)},!1)}var m,g,y,w,b=window.MutationObserver||window.WebKitMutationObserver;b?new b(h).observe(obj,{childList:!0,subtree:!0}):(m={},g=document.documentElement,window.addEventListener&&(p("DOMSubtreeModified"),p("DOMNodeInserted"),p("DOMNodeRemoved")),m.DOMNodeInserted?window.addEventListener("DOMContentLoaded",function(){m.DOMSubtreeModified?g.addEventListener("DOMSubtreeModified",h,!1):(g.addEventListener("DOMNodeInserted",h,!1),g.addEventListener("DOMNodeRemoved",h,!1))},!1):document.onpropertychange?document.onpropertychange=h:(y=document.getElementsByTagName("*"),w=y.length,setTimeout(function e(){var n=document.getElementsByTagName("*"),t=n.length;t!=w&&(y=[]);for(var o=0;o<t;o++)if(n[o]!==y[o]){h(),y=n,w=t;break}setTimeout(e,v)},v)));const O=200;function D(n){var e,t;e=e=>{e.forEach(e=>e.addedNodes.length&addedNodes.push(...e.addedNodes)),e.forEach(e=>e.removedNodes.length&removedNodes.push(...e.removedNodes)),n(e)},(t=O)&&(v=t),l.push(e)}return e.autoGrabber=function(t,r,o=[]){if(!Array.isArray(o))throw"should pass an array to the middlewares";if(t.projectID&&t.apiKey){var{projectID:e,apiKey:n}=t;new a(e,n,user)}else if(!t.sendEvent)throw"ingrow be an instance of Ingrow class or contains ingrow sdk configs";const i=[{type:"mouse",stream:"events",sendDeviceInfo:!1,capture:u},{type:"page",stream:"events",sendDeviceInfo:!0,capture:c},{type:"domChange",stream:"events",sendDeviceInfo:!1,capture:D},{type:"error",stream:"events",sendDeviceInfo:!1,capture:f}];r&&o.push((e,n)=>{let t=r[e.type]?.rate;var o;t=-1<t?t:1,o=t,Math.random()<o&&n(e)}),o.push((e,n)=>{t.send(e.stream,e.eventData,e.sendDeviceInfo)}),i.forEach(n=>{n.capture(e=>{n.eventData=e,function n(t,o){t.length&&t[0](o,e=>{n(t.slice(1),e||o)})}(o,e)})})},Object.defineProperty(e,"__esModule",{value:!0}),e}({});
